# Firestore Data Model

This document outlines the intended structure for data within Firestore.

**Root Collection:** `users`

*   Each document ID represents a `userId` obtained from Firebase Authentication.

**User Document Structure:** `/users/{userId}`

*   **Fields:** Potentially user profile information (e.g., `displayName`, `email`), although not strictly necessary initially.
*   **Subcollections:**
    *   `transactions`
    *   `categories`
    *   `budgets` (Planned for Phase 5)

---

**Subcollection: `transactions`**

*   **Path:** `/users/{userId}/transactions/{transactionId}`
*   **Document ID (`transactionId`):** Unique ID (UUID generated by the Android client).
*   **Data Structure (`TransactionData`):**
    ```json
    {
      "id": "string (same as documentId)",
      "userId": "string (matches parent {userId})",
      "date": "timestamp", // Firestore Timestamp object
      "amount": "number", // Float
      "isIncome": "boolean",
      "description": "string | null", // Full SMS body
      "provider": "string | null", // SMS sender address
      "contactName": "string | null", // Contact name if matched
      "accountInfo": "string | null", // Masked account info like *1234
      "categoryId": "string | null" // ID linking to a category document, null initially
    }
    ```

---

**Subcollection: `categories`**

*   **Path:** `/users/{userId}/categories/{categoryId}`
*   **Document ID (`categoryId`):** Unique ID (UUID generated client-side or by Firestore).
*   **Data Structure (`Category`):**
    ```json
    {
      "id": "string (same as documentId)",
      "userId": "string (matches parent {userId})",
      "name": "string",
      "color": "number" // Integer representing color (e.g., Android Color Int)
    }
    ```

---

**Subcollection: `budgets` (Planned)**

*   **Path:** `/users/{userId}/budgets/{yearMonth}` (e.g., `2025_04`)
*   **Document ID (`yearMonth`):** String identifying the budget period.
*   **Data Structure:**
    ```json
    {
      "yearMonth": "string (same as documentId)",
      "userId": "string (matches parent {userId})",
      "budgetLimits": {
        "categoryId1": "number", // Budget amount for category 1
        "categoryId2": "number", // Budget amount for category 2
        // ... other category IDs
      },
      "totalBudget": "number" // Optional: overall budget for the month
    }
    ```

---

**Security Rules:**

*   See `firestore.rules` in the project root.
*   Rules enforce that users can only read/write data under their own `/users/{userId}` path. 